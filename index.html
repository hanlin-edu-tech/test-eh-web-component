<html>
    <head>
        <style>
            :not(:defined) {
                background-color: #AAA;
            }

            body {
                display: flex;
                flex-flow: column;
            }

            eh-header {
                transition: background-color 0.5s;
                display: flex;
                width: 100%;
                height: 50px;
            }

            .list {
                border: 3px #999 solid;
            }

            .A {
                color: #F00;
            }

            .B {
                color: #0F0;
            }

        </style>
    </head> 
    
    <body>
        <template id="eh-index-list">
            <h3>這是清單</h3>
            <ul>
                <slot></slot>
            </ul>
        </template>
        <template id="eh-index-list-item">
            <style>
                :host {
                    all: initial;
                    border: 1px #33F solid;
                    display: flex;
                }
            </style>
            <li>
                <slot name="item-key"></slot> : <slot name="item-value"></slot>
            </li>
        </template>
        <script>
            let defineCustomElement = (id) => {
                customElements.define(id, class extends HTMLElement {
                    constructor() {
                        super();
                        let shadowRoot = this.attachShadow({mode: 'open'});
                        let t = document.querySelector(`#${id}`);
                        let instance = t.content.cloneNode(true);
                        shadowRoot.appendChild(instance);
                    }
                });
            };

            defineCustomElement('eh-index-list');

            customElements.define('eh-index-list-item', class extends HTMLElement {
                constructor(itemKey, itemValue) {
                    super();
                    let shadowRoot = this.attachShadow({mode: 'open'});
                    let t = document.querySelector('#eh-index-list-item');
                    let instance = t.content.cloneNode(true);
                    if(itemKey){
                        instance.querySelector("slot[name=item-key]").innerHTML = itemKey;
                    }
                    if(itemValue){
                        instance.querySelector("slot[name=item-value]").innerHTML = itemValue;
                    }
                    shadowRoot.appendChild(instance);
                }
            });

        </script>


        <eh-header></eh-header>
        <eh-index-list class="list A">
            <eh-index-list-item>
                <span slot="item-key">K1</span>
                <span slot="item-value">V1</span>
            </eh-index-list-item>
            <eh-index-list-item>
                <span slot="item-key">K2</span>
                <span slot="item-value">V2</span>
            </eh-index-list-item>
        </eh-index-list>
        <eh-index-list id="listB" class="list B"></eh-index-list>

        <script>
            let listB = document.querySelector('#listB');
            let listItem = customElements.get('eh-index-list-item');
            for (let i = 0; i < 10; i++) {
                listB.appendChild(new listItem(`K-${i}`, `V-${i}`));
            }
        </script>


        <!--未來應該是放在另一隻JS中的通用元件 >>> -->
        <template id="eh-header">
            <style>
                .logo {
                    width: 304px;
                    height: 35px;
                }
            </style>
            <header>
                <a href="/index.html"><img class="logo" src="https://www.ehanlin.com.tw/images/ehanlin_logo.svg"/></a>
                <nav>
                    <a>購物車</a> | <a>課程開通</a> | <a>免費試用</a> | <a>使用幫手</a>
                </nav>
            </header>
        </template>
        <script>
            //模擬載入外部JS的時間差
            setTimeout(() => {
                customElements.define('eh-header', class extends HTMLElement {
                    constructor() {
                        super();
                        let shadowRoot = this.attachShadow({mode: 'open'});
                        let t = document.querySelector('#eh-header');
                        let instance = t.content.cloneNode(true);
                        shadowRoot.appendChild(instance);
                    }
                });
            }, 2000);
        </script>
        <!-- <<< 未來應該是放在另一隻JS中的通用元件-->

    </body>
</html>